---
title: linux用户和用户组操作
date: 2023-05-14
---
<Boxx/>

# linux用户和用户组操作

## 1-用户和用户组的作用

**作用**

1. 用户：
   1. 就是创建的登录用户  root （超级）用户   lubei 和 tom 是普通用户   登录linux系统
   2. 区分文件创建者 （比如某个文件是谁创建的 doupo.txt 都是root创建的）
   3. 确保能够准确的追踪操作者 
2. 用户组
   1. 多个用户 可以组成 一个组 
   2. 就是 tom 和 jik 是一个组的他们都有相同的功能 或者可以共同使用的东西
   3. doupo.txt 是root 创建的  tom  jik （jik tom是不可以用root 的东西的）但是如果是一个组的就可以了

## 2-用户与用户组的关系

**解释**

1. 现有用户组 后有用户
2. 一个组可以有多个人 一个组也可以有一个人

## 3-用户组

**解释**

1. linux 里面是有 用户的组的 那么这些用户组 在哪里 ？
2. 用户组 在 /etc/group  这个文件下

```SH
#  vim /etc/group  打开用户组的配置文件（保存的位置）
```

**解释用户组的配置意思**

```sh
lubei:x:1000:lubei
# 用户组的名字:用户组的密码:用户组的编号:同属于一个组的用户（副属组的人）
```

1. 上面重要的 除了密码 不用关注 其他的都需要记住

## 4-linux增加用户命令

**基本语法**

1. 使用 useradd 指令增加用户

**选项**

1. -g  指定用户的主组
2. -G 指定用户的副属组
3. -s 指定用户的可以控制的shell 类型
4. -d 指定用户的家目录

**注意**

1. 使用  useradd  tom 在用户没有指定主组的时候会自动创建跟用户相同的组 
2. 在没有指定用户家目录的时候 家目录的名字跟用户的名字 一样
3. /sbin/nologin 这个是 没有登录权限的意思

| 规范                          | 案例-意思                                              |
| ----------------------------- | ------------------------------------------------------ |
| useradd   用户名字            | useradd  tom 增加用户tom                               |
| useradd  -g 主组的编号 用户名 | useradd -g 1000 jik 增肌jik用户设置主组是1000 那个组   |
| useradd -G 组的编号 用户名字  | useradd -G 1000 qqq  设置qqq的副属组是1000编号的哪个组 |
| useradd -s shell类型 用户名   | useradd -s /sbin/nologin eee 增加eee用户但是不能登录   |
| useradd -d /home/用户家       | useradd -d /home/yyy rrr 设置rrr用户的家是yyy          |

## 5-linux跟用户相关的文件

**解释**

1. /etc/passwd  这个文件 跟用户相关

![1713943873511](/assets/1713943873511.png)

```sh
rrr:x:1006:1006::/home/yyy:/bin/bash

用户名字:密码:用户的id:用户的主组编号:用户的家目录:shell类型
```

**常用的shell类型**

```shell
/bin/bash  可以进行全部操作

/sbin/nologin  有这个账户 但是不能登录
```

## 6-linux用户修改命令

**基本语法**

1. 使用 usermod 指令修改

**选项**

1. -g  指定用户的主组
2. -G 指定用户的副属组
3. -s 指定用户的可以控制的shell 类型
4. -d 指定用户的家目录
5. -L 锁定用户  不能用密码登录 （root-》普通的时候不需要密码 普通到普通的时候需要）
6. -U 解锁用户  

**注意**

1. 修改-g 主组 或者 副属组 ，必须有哪个组
2. -s 修改的shell类型并不能确定 你有多杀操作  只是基本上命令是可以的 
3. 真正的可以有多少操作是 看用户的权限
4. 不要让多个用户 都是属于一个家目录 
5. 如果这个家目录 是没有 主人的  可以设置吗？
   1. 可以

| 规范                         | 案例-意思                                     |
| ---------------------------- | --------------------------------------------- |
| usermod  -g  组编号  用户名  | usermod -g 1003 jik 修改jik主组为1003         |
| usermod  -G  组编号  用户名  | usermode -G 1006 qqq 修改qqq副组是1006        |
| usermod -s shell类型 用户名  | usermod -s /bin/bash qqq                      |
| usermod -d /home/目录 用户名 | usermod -d /home/ppp rrr 修改rrr的家目录为ppp |
| usermod -L  用户             | usermod -L ceshi 锁定ceshi用户不能密码登录    |
| usermod -U 用户              | usermod -U ceshi 解除用户的锁定               |

## 7-passwd 修改密码指令

**基本语法**

| 场景-规范                | 案例-意思                                                 |
| ------------------------ | --------------------------------------------------------- |
| 处于登录中的用户  passwd | passwd 可以直接修改当前用户密码 需要提供旧密码            |
| passwd  用户名           | 只能root 用户才可以修改别人的密码 不需要新密码 不限定格式 |

## 8-linux删除用户指令

**基本语法**

1. 删除的时候考虑好 
2. 使用userdel 删除用户

**选项**

1. -r  指把用户的 家目录也删除

| 规范                | 案例-意思                                   |
| ------------------- | ------------------------------------------- |
| userdel  用户名字   | userdel tom 删除tom用户但是不删除家目录     |
| userdel -r 用户名字 | userdel -r www 删除www用户 并且删除用户的家 |

## 9-删除正在登录的用户

**案例**

1. 当你输入 userdel -r qqq 的时候  控制台输出 user qqq ....by process 63569 表示这个用户正在登陆中
2. 登录用户就是一个进程 （因为是一个操作）这个操作的编号id 就是 63569 

```sh
[root@localhost ~]# userdel -r qqq
userdel: user qqq is currently used by process 63569
```

![1713950029271](/assets/1713950029271.png)

**注意**

上面的 63569 进程正在进行中 所以 不能删除 63569 进程的用户 qqq

**如何删除**

```sh
kill 进程号

kill -9 进程号 （强制杀死）

userdel 用户
```

**案例解释**

```sh
[root@localhost ~]# userdel -r qqq
userdel：没有删除 qqq 组，因为它是另外一个用户的主组。

解释:
	执行 userdel -r qqq (删除用户的家 和 用户)
	qqq 的家 跟另一个用户还有关系  qqq 和www 属于 一个主组 
	有可能后面  www 还需要使用 qqq 用户的一些相关文件 所以保留 了 qqq 的家
```

**例子**

1. xxxx 公司 有 两个 员工  一个 叫 王哥  一个叫 李哥 
   1. 王哥 是公司起步 就开始在公司  共公司的服务器 防火墙  等...服务都是 王哥操作的 这个时候 王哥需要离职   这个公司 会删除 王哥的用户 但是不会删除王哥的家目录
   2. 李哥 来了 就是玩 唯一就创建了个用户 执行了一个 rm -rf  他离职就会删除 家目录和用户信息

## 10-kill杀死进程指令

**基本语法**

1. 杀死 qqq 用户登录 进程  你的终端会进行退出qqq 会出现不受控制的情况 没事不要担心 按enter 等待注销qq用户后 他会自动连接 root

| 规范           | 案例-意思                                                |
| -------------- | -------------------------------------------------------- |
| kill 进程号    | kill 63569 表示杀死 63569进程 有些强硬的进程是无法删除的 |
| kill -9 进程号 | kill -9 63569 表示强制杀死进程                           |
