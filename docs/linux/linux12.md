---
title: linux防火墙
date: 2023-05-28
---
<Boxx/>

# linux防火墙

## 1-防火墙概述

**基本解释**

1. 防（防止）火（网上的黑客侵入）的 墙（阻挡的东西）

**作用**

1. 会根据防火墙的 规则 可以限制 某些流量的进入 和流出
2. 防火墙  有 硬件防火墙  软件防火墙

![1714121261766](/assets/1714121261766.png)

**硬件防火墙**

```sh
# 理解为也是一个电脑主机 
# 防火墙一般自带  可视化面板的防火规则
# 设置那些流量可是流出 那些不可以
```

**windows 防火墙**

![1714121539578](/assets/1714121539578.png)

1. 案例  使用 iis部署的 魔兽世界游戏 一开始其他人无法访问的
2. 关闭防火墙之后可以了

## 2-Linux部署服务防火墙了解

**案例 ：在虚拟机的linux 里面跑一个前端网页服务**

```sh
#1. 需要安装 httpd 这个服务软件(阿帕奇)  在执行安装的时候 卡住 ？ y n 输入 y 回车
	yum install httpd
#2.	安装完毕之后这个服务是默认关闭的 需要启动这个服务
	systemctl start httpd
#3.httpd 这个服务是一个前端网页服务 默认他是运行在 80端口
    访问你的虚拟机地址就可以访问80端口的前端服务
#4.访问 在浏览器就可以 192.168.146.135 无法访问 
	无法访问的原因是 linux虚拟机 的防火墙指定的规则 是不允许外机访问 httpd服务的
#5.可以关闭防火墙 解决不能访问的问题
   systemctl stop firewalld
#6.在 浏览器再次输入 ip地址就可以了
```

**部署自定义前端项目**

1. 使用的是 关闭防火墙 

```sh
#1.把 前端打包后的项目 放入 httpd 的相关的 文件夹中 及可以访问你的 前端项目
方式1：需要把index.html 上传到 /var/www/html 文件夹下
方式2：如果上传魔兽世界那个 就需要 替换掉 /var/www/的html 这个文件夹
```

## 3-linux防火墙两种模式

**防火墙模式两种**

- 运行模式（临时模式） ：就是用户修改了关于防火墙的相关规则配置会 立刻生效 但是不长久保存
- 永久模式：就是用户修改了防火墙的相关规则配置 不会立刻生效 需要 使用防火墙的 热重载重新加载配置规则 然后才生效  但是这个生效是永久的

## 4-linux防火墙基本操作

**基本语法**

| 命令                          | 意思                                         |
| ----------------------------- | -------------------------------------------- |
| systemctl  start   firewalld  | 启动防火墙                                   |
| systemctl  stop  firewalld    | 关闭防火墙                                   |
| systemctl  restart  firewalld | 重启防火墙                                   |
| systemctl  status   firewalld | 查看防火墙的状态                             |
| systemctl  reload  firewalld  | 热重载防火墙（不关闭防火墙自动加载规则配置） |
| systemctl  enable  firewalld  | 设置防火墙为开机启动模式                     |
| systemctl  disable  firewalld | 设置防火墙为开机不启动模式                   |

## 5-linux规则命令 与 区域

**规则相关命令**

**注意**：防火墙的指令 统一  以  **firewall-cmd** 开头

| firewall-cmd 后面的命令配置 | 意思                                 |
| --------------------------- | ------------------------------------ |
| --get-default-zone          | 获取当前正在使用的**区域**           |
| --get-zones                 | 获取所有可以用的**区域**             |
| --list-all                  | 获取正在使用的**区域**相关的规则配置 |
| --list-all-zones            | 获取所有可以用的**区域**的配置规则   |

**区域解释**

- 区域 是 centos7 新增的一个 跟防火墙相关的名字 
- 这个区域名词里 带着防火墙相关的一些 规则（windows 的出站规则  入站规则 ）
- 默认linux 自带一些默认的防火墙规则 他分为了好几种 这种规则 叫  **区域**     比如数据库的： 3306端口这就是规则 

**常见的区域规则表**

| 区域       | 默认自带的规则                                               |
| ---------- | ------------------------------------------------------------ |
| trusted    | 默认接受所有 流入 流出的规则                                 |
| **public** | **拒绝所有流入的流量，除非与流出相关的 允许 ssh（22） dhcpv6-client** |
| internal   | 拒绝所有流入的流量，除非与流出相关的  ssh mdns samba-client dhcpv6-client |
| home       | 跟internal  一样的                                           |
| external   | 拒绝所有流入的流量，除非与流出相关的  允许 ssh 服务          |
| drop       | 拒绝所有流入的流量，除非与流出相关的  只要是非法的流量默认是丢弃 |
| dmz        | 拒绝所有流入的流量，除非与流出相关的  允许 ssh服务           |
| block      | 拒绝所有流入的流量，除非与流出相关的  只要是非法的流量默认是拒绝 |

## 6-linux开放允许的 服务 或 端口（精准开放）

**运行模式下的设置方式**



**基本语法**

**案例**

1. 一般正常的运行的服务 都是防火墙启动的 不能关闭 默认都是启动的

**方式一：使用服务的名字开启规则增加**

```sh
#1.默认我们的httpd 服务的名字叫 http
#2.可以使用 防火墙的 精确开启允许的服务 来实现魔兽世界网页的访问
firewall-cmd --zone=public --add-service=http
```

**方式一：使用服务的名字开启规则移除**

```sh
firewall-cmd --zone=public --remove-service=http
```

**方式二：使用服务的端口号开启规则**

```sh
#1.默认我们的httpd 服务都是使用80端口
#2.可以使用 防火墙的 精确开启允许的服务 来实现魔兽世界网页的访问
firewall-cmd --zone=public --add-port=80/tcp
```

**方式二：使用服务的端口开启规则移除**

```sh
firewall-cmd --zone=public --remove-port=http
```



**永久模式下的设置**



**基本语法**

**案例**

1. 一般正常的运行的服务 都是防火墙启动的 不能关闭 默认都是启动的

**方式一：使用服务的名字开启规则**

```sh
#1.默认我们的httpd 服务的名字叫 http
#2.可以使用 防火墙的 精确开启允许的服务 来实现魔兽世界网页的访问
firewall-cmd --zone=public --add-service=http --permanent
firewall-cmd --reload
```

**方式二：使用服务的端口号开启规则   推荐使用**

```sh
#1.默认我们的httpd 服务都是使用80端口
#2.可以使用 防火墙的 精确开启允许的服务 来实现魔兽世界网页的访问
firewall-cmd --zone=public --add-port=80/tcp --permanent
fierwall-cmd --reload
```

**统一移除方式**

```sh
firewall-cmd --zone=public --remove-(port/service)=(80/tcp 、服务名字) --permanent
fierwall-cmd --reload
```
