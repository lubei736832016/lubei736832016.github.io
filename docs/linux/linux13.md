---
title: linux计划任务
date: 2023-06-04
---
<Boxx/>

# 计划任务

## 1-计划任务概述

- 我们指定一个计划  在某个时间进行主动完成 就是计划任务 也可以叫定时任务，
- 案例：比如我想在凌晨 3：00 的时候 重启一下网络服务 
  - 方式1 派一个员工 在3：00 的时候 蹲在这里 看着 3：00 重启
  - 使用计划任务 （自已定义好时间 然后计算机自动重启） 

## 2-windows的计划任务

**步骤**

![1714273805939](/assets/1714273805939.png)

![1714273842998](/assets/1714273842998.png)

![1714273880099](/assets/1714273880099.png)

![1714273908903](/assets/1714273908903.png)

![1714273952212](/assets/1714273952212.png)

![1714273969118](/assets/1714273969118.png)

![1714274003391](/assets/1714274003391.png)

**点击完成可以了**

## 3-linux的crontab计划任务

**基本语法**

**选项**

1. -e  编辑crontab  计划任务
2. -l   显示所有正在运行的计划任务

| 命令       | 意思                     |
| ---------- | ------------------------ |
| crontab -e | 打开编写计划任务的编辑器 |
| crontab -l | 查看所有运行的计划任务   |

```sh
#计划任务的 编写 规则 
#1. 规则： 分 时 日 月 周  执行的命令  实际写的 * * * * *  mkdir file

#  * 表示每个 分的话就是每分钟 时每个小时 日 月 周
#  - 表示几 到 几  15-30  15-20  
#  ， 表示 1，2，3 选择多个值
#  /  除的意思  */30 表示每隔 30分钟

==  每个单位的可取值 ==

分 ：1-59
时 ：1-23
日 ：1-31
月 ：1-12
周 ：0 -7 #  中：周一是一周的第一天  美：星期天是第一天 07 都表示 星期天 1-7
```

**注意：** 

- 在计划任务的编辑文档中  **一行编辑的内容** 就是**一个计划任务**
- 有时候 在计划任务的里面写的命令 必须是命令的 完整路径  
- 如何查找 命令的完整路径  
  - **使用 which  命令  可以得到完整路径**

## 4-crontab计划任务案例

**案例一**：每个月的 3，13，26 日的 3：45 的时候重启 network网络配置

```sh
# 分 时  日 月 周  命令
 45  3  3,13,26  *  *   systemctl restart network
```

**案例二**：每个周六，周日的 12：15分 关闭防火墙

```powershell
# 分 时  日 月 周  命令
  15 12 *  *  6，7   systemctl ....      
```

**案例三**：每天的 18：00到 22：00 点之间 每隔 20分钟 重启网络

```sh
# 分   时    日 月 周  命令
 */20 18-22 *  *  *    命令
```

**案例四**：每隔两天的上午 9：00到 11点 的第 3 第20 分钟 向 ceshi.txt 文件中追加一个 数字1

```sh
# 分   时    日 月 周  命令
3,20  9-11  */2 *  *   echo '1' >> ceshi.txt
```

**案例五**：每分钟向 ceshi.txt 中追加 一个  ‘我是linux’

```sh
# 分   时    日 月 周  命令
 * * * * *   echo '1' >> ceshi.txt
```

## 5-at计划任务(一次性的)

**安装at计划任务**

```sh
yum install at -y 默认全部安装
```

**基本语法**

1. am  表示上午   pm 表示下午  days 表示天  now 表示立刻
2. 支持的语法  8：00 am   9：15 pm 
3. 8:00am + 3 days

```sh
[root@localhost ~]#  at 后面加 我们的时间设定和 命令就可以了
```

**案例**

```sh
[root@localhost /]# at 3:22pm   定义好具体的时间
at> echo '1' >> /ceshi.txt     写命令推荐换行写命令
at> <EOT>   推荐换行 结束 （ctrl+d）
```

## 6-crontab计划任务黑名单

**基本语法**

1. 默认linux 用户都可以写计划任务
2. 可以设置权限 比如 某某不可以用计划任务

```sh
只需要 把用户的名字添加到 /etc/cron.deny 文件里面就可以限制 该用户的 计划任务权限
```
